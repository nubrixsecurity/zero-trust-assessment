<#
    FLAGS:
    -SkipExecSummary (optional)
    -SkipSecureScore (optional)
    -SkipLicenseReview (optional)
    -KeepZtExport   (optional; keeps the zt-export folder instead of deleting it)
    -OpenOutput     (optional; opens OutputPath at end)
#>

$tenantId = "your-tenant-id"
$subId    = "your-subscription-id"

$ztaTemp = Join-Path $env:TEMP "nubrix-zta"
New-Item -Path $ztaTemp -ItemType Directory -Force | Out-Null

$u = "https://raw.githubusercontent.com/nubrixsecurity/zero-trust-assessment/main/invoke-zta.ps1"
$p = Join-Path $ztaTemp "invoke-zta.ps1"

Invoke-WebRequest -Uri $u -OutFile $p -ErrorAction Stop
pwsh -NoProfile -ExecutionPolicy Bypass -File $p -TenantId $tenantId -SubscriptionId $subId
